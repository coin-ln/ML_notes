# word2vec

```python
from gensim.models import word2vec
```

## LineSentence(sentence_path)

按行读取文件内容，并返回列表，列表中空格隔开各个元素

eg:

```python
from gensim.models.word2vec import LineSentence

# 读取文本文件并按行生成句子
sentences = LineSentence('corpus.txt')

# 遍历生成的句子
for sentence in sentences:
    print(sentence)

'''
intput:
This is the first sentence.
Here is the second sentence.
And this is the third sentence.

output:
['This', 'is', 'the', 'first', 'sentence', '.']
['Here', 'is', 'the', 'second', 'sentence', '.']
['And', 'this', 'is', 'the', 'third', 'sentence', '.']

'''
```

## Word2Vec()

```python
model=Word2Vec()
'''
`Word2Vec` 是 Gensim 库中用于训练 Word2Vec 模型的类。它接收一些参数来控制模型的训练过程和性能。下面是对一些常用参数的详细解释：

1. `sentences`：表示用于训练模型的句子集合。它可以是一个可迭代对象（如列表、生成器），每个元素是一个句子（以单词列表的形式表示）。句子集合可以通过 `LineSentence` 等方法生成。

2. `size`：表示生成的词向量的维度（即词向量的长度）。默认值为 100。较大的值会导致更多的内存占用，但可能提供更好的表示能力。

3. `window`：表示当前单词和预测单词之间的最大距离（以单词数量计算）。默认值为 5。较小的窗口大小会更关注当前单词附近的上下文，而较大的窗口大小会考虑更广泛的上下文信息。

4. `min_count`：表示单词在语料库中出现的最小次数。如果一个单词的出现次数少于 `min_count`，则会被忽略掉，不会被包含在词汇表中。默认值为 5。通过设置一个较大的值，可以过滤掉一些出现频率较低的单词，减少模型大小和训练时间。

5. `sg`：表示选择使用哪种模型架构，取值为 0 或 1。当 `sg=0` 时，使用连续词袋模型（CBOW）；当 `sg=1` 时，使用跳字模型（Skip-gram）。默认值为 0。

6. `hs`：表示选择使用哪种训练算法来优化模型参数，取值为 0 或 1。当 `hs=0` 时，使用负采样算法；当 `hs=1` 时，使用层级 softmax 算法。默认值为 0。层级 softmax 在大型语料库上的训练速度较慢，但可能会提供更好的模型质量。

7. `negative`：表示负采样算法中负样本的数量。默认值为 5。负采样是用来训练模型的一种方法，在每个训练样本中随机选择一些单词作为负样本，以便更好地学习单词之间的关系。

8. `workers`：表示训练模型时使用的线程数。默认值为 3。通过设置大于 1 的值，可以加速模型的训练过程。

以上只是一些常用的参数，`Word2Vec` 类还有其他参数，如 `alpha`、`epochs

`、`min_alpha` 等，用于控制学习速率、训练轮数等。根据具体的需求和语料库特点，可以选择合适的参数值来训练和优化 Word2Vec 模型。
'''
```

eg:

```python
def train_model(text_path,model_path):
    texts = word2vec.LineSentence(text_path)
    model = word2vec.Word2Vec(texts, hs=1,min_count=1,window=3,vector_size=100)
    print('Word2Vec Training Endding!')
    model.save(model_path)
def analyse_wordVector(model_path):
    model =  word2vec.Word2Vec.load(model_path)

```

`Word2Vec` 类具有多个属性，用于访问和操作训练好的 Word2Vec 模型。下面是一些常用的属性及其说明：

1. `wv`：词向量（Word Vectors）
   - 通过访问 `wv` 属性，可以获取词向量。例如，`model.wv['computer']` 返回单词 "computer" 的词向量。
   - 可以使用这些词向量进行词语相似度计算、词语聚类、文本特征表示等任务。

2. `vocabulary`：词汇表
   - `vocabulary` 属性是一个词汇表对象，包含了训练过程中出现的所有单词及其对应的索引。
   - 可以使用 `vocabulary` 属性来获取单词的索引、检查单词是否在词汇表中等。

3. `vector_size`：词向量的维度
   - `vector_size` 属性表示训练得到的词向量的维度。

4. `window`：窗口大小
   - `window` 属性表示模型训练时使用的窗口大小，即当前单词与上下文单词的最大距离。

5. `min_count`：最小词频
   - `min_count` 属性表示在构建词汇表时考虑的最小词频。词频低于该值的单词将被忽略。

6. `hs`：层级 softmax
   - `hs` 属性用于指定是否使用层级 softmax 算法进行训练。

7. `epochs`：训练轮数
   - `epochs` 属性表示训练过程中的迭代轮数。

8. `alpha` 和 `min_alpha`：学习速率
   - `alpha` 属性表示初始学习速率，而 `min_alpha` 属性表示最小学习速率。学习速率会随着训练的进行逐渐降低。

这些属性提供了对训练好的 Word2Vec 模型的访问和控制，可以根据具体需求使用它们进行词向量的获取、参数的调整以及其他相关操作。

### wv

```python
'''
在Word2Vec模型中，`wv`是Word2Vec类的一个属性，表示Word2Vec模型的词向量空间。它提供了一系列方法和属性用于操作和获取词向量。

下面是`wv`的一些常用属性和方法的详细解释：

1. `wv.vocab`: 一个字典，键为词汇表中的单词，值为对应的Vocab对象。Vocab对象包含了单词的索引、词频等信息。

2. `wv.index_to_key`: 一个列表，包含了词汇表中所有单词的按索引顺序排列。可以通过索引来获取对应的单词。

3. `wv.key_to_index`: 一个字典，键为词汇表中的单词，值为对应的索引。可以通过单词获取其在词汇表中的索引。

4. `wv.vector_size`: 词向量的维度大小。表示每个单词的词向量的长度。

5. `wv.get_vector(word)`: 获取指定单词的词向量。返回一个一维NumPy数组，表示该单词的词向量。

6. `wv.get_vectors(words)`: 获取多个单词的词向量。接受一个单词列表作为参数，并返回一个二维NumPy数组，每行表示一个单词的词向量。

7. `wv.most_similar(positive=None, negative=None, topn=10)`: 寻找与给定单词最相似的单词。可以通过指定positive和negative参数来进行词语之间的线性组合。topn参数表示返回相似单词的数量。

8. `wv.similarity(word1, word2)`: 计算两个单词之间的余弦相似度。返回值在[-1, 1]之间，值越接近1表示两个单词越相似。

9. `wv.doesnt_match(words)`: 判断给定单词列表中哪个单词与其他单词不相关。返回不相关的单词。

这些属性和方法可以帮助你在Word2Vec模型中进行词向量的获取、相似度计算、词语关系的分析等操作。你可以根据具体的需求选择合适的方法来处理和操作词向量。
'''
```

eg:

```python
def analyse_wordVector(model_path):
    model =  word2vec.Word2Vec.load(model_path)
    print('Nearest 周瑜:',model.wv.most_similar('周瑜'))
    print('Nearest 刘备:,',model.wv.most_similar(['刘备']))
    print('Nearest 曹操:',model.wv.most_similar(['曹操']))
    print('Nearest 孙策:',model.wv.most_similar(['孙策']))
    print('Nearest 貂蝉:',model.wv.most_similar(['貂蝉']))
    print('Nearest 诸葛亮:', model.wv.most_similar(['诸葛亮']))
    print(model.wv.doesnt_match(u"周瑜 鲁肃 吕蒙 陆逊 诸葛亮".split()))
    print(model.wv.doesnt_match(u"曹操 刘备 孙权 关羽".split()))
    print(model.wv.doesnt_match(u"关羽 张飞 赵云 黄忠 马超 典韦".split()))
    print(model.wv.doesnt_match(u"诸葛亮 贾诩  张昭 马超".split()))
    print(model.wv.similarity('诸葛亮','司马懿'))
    print(model.wv.similarity('曹操','司马懿'))
    print(model.wv.similarity('大乔', '小乔'))
analyse_wordVector('model')

'''
output:
Nearest 周瑜: [('司马懿', 0.950598955154419), ('先主', 0.949810266494751), ('孙权', 0.9451960921287537), ('关公', 0.9437651634216309), ('陆逊', 0.9435572028160095), ('孟获', 0.941710889339447), ('吕布', 0.9398935437202454), ('庞统', 0.9389603734016418), ('云长', 0.9362606406211853), ('姜维', 0.9360907673835754)]
Nearest 刘备:, [('孤', 0.9551385641098022), ('公', 0.9518376588821411), ('肃', 0.9483628869056702), ('此人', 0.9482020735740662), ('布', 0.947688639163971), ('吾', 0.9461888670921326), ('瑾', 0.9456201195716858), ('今日', 0.9452023506164551), ('策', 0.9451797604560852), ('权', 0.9446168541908264)]
Nearest 曹操: [('孙权', 0.9456920623779297), ('先主', 0.9340988993644714), ('周瑜', 0.933207094669342), ('司马懿', 0.9303578734397888), ('袁绍', 0.9109686017036438), ('孔明', 0.9050646424293518), ('东吴', 0.9037068486213684), ('吕布', 0.9025403261184692), ('后主', 0.9024657607078552), ('孙策', 0.9002562165260315)]
Nearest 孙策: [('魏主', 0.9452693462371826), ('孙权', 0.9440484046936035), ('江夏', 0.941910445690155), ('司马懿', 0.9389466047286987), ('诸葛', 0.9354034662246704), ('吕蒙', 0.9342080354690552), ('吕布', 0.933163046836853), ('军前', 0.9331251978874207), ('周瑜', 0.930729329586029), ('使者', 0.9294333457946777)]
Nearest 貂蝉: [('孤', 0.946850597858429), ('承', 0.9398341774940491), ('公瑾', 0.9384630918502808), ('妾', 0.9350747466087341), ('叔父', 0.9323621392250061), ('盖', 0.9301311373710632), ('术', 0.9284744262695312), ('从事', 0.928242027759552), ('公', 0.9268796443939209), ('会', 0.9246112704277039)]
Nearest 诸葛亮: [('公', 0.9420602321624756), ('他人', 0.9405077695846558), ('计', 0.9391981363296509), ('刘备', 0.9390828609466553), ('皇叔', 0.9379285573959351), ('之意', 0.9370032548904419), ('德', 0.9356804490089417), ('哉', 0.934687077999115), ('奈何', 0.9344265460968018), ('不知', 0.9331480860710144)]
诸葛亮
关羽
关羽
马超
0.9307294
0.3983679
0.75198746
'''
```

